#! /bin/bash
# launched on first user startup, this script is used for things that only
# need to be done once. This script must delete itself at the end.
##########################################################################
# set SuccessCheck to 1 if anything dont work set it to 0 so the script 
# will run again
SuccessCheck=1
##########################################################################
# rename libpurple default users with username if exists
temp=$(more ~/.purple/accounts.xml | grep -c AwesomeUserWhoMightBeANoob)
if [ $temp -ge 1 ]; then
	IRCusername=$(echo $(whoami)""$RANDOM"@")
	username=$(echo $(whoami)"@"$(hostname))
	sed -i.bak "s/AwesomeUserWhoMightBeANoob@/${IRCusername}/g" ~/.purple/accounts.xml
	sed -i.bak "s/AwesomeUserWhoMightBeANoob/${username}/g" ~/.purple/accounts.xml
	#########################
	# check everything worked
	temp=$(more ~/.purple/accounts.xml | grep -c AwesomeUserWhoMightBeANoob)
	if [ $temp -ge 1 ]; then
		SuccessCheck=0
	fi
fi
# Add the default empty directories
mkdir -p ~/Downloads
mkdir -p ~/Music
mkdir -p ~/Templates
mkdir -p ~/Desktop
mkdir -p ~/Pictures
mkdir -p ~/Documents
mkdir -p ~/Videos

# delete this script if everything has worked 
if [ $SuccessCheck -ge 1 ]; then
	rm -v ~/.first_start
fi
